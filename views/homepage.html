<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/public/css/log.css">
    <title>Homepage</title>
</head>

<style>
    #button-home-news {
        background-color: white;
        border: 1px solid #e0dddd;
        padding-top: 1em;
        padding-bottom: 1em;
        padding-right: 2em;
        transition: transform 0.3s ease;
    }

    #button-home-newsauc {
        background-color: white;
        border: 1px solid #e0dddd;
        border-top: none;
        padding-top: 1em;
        padding-bottom: 1em;
        padding-right: 2em;
        transition: transform 0.3s ease;
    }
</style>

<body id="body">

    <nav class="navbar" id="navhome">
        <div class="container-fluid" id="home">
            <button class="btn" type="button" id="btnhome">
                <h3 id="taladH">ตลาดประมูลการยางภาคเหนือ</h3>
            </button>

            <div class="dropdown">
                <button type="button" id="username" class="btn" data-bs-toggle="dropdown"><img
                        src="/public/img/userbutton.png" alt="" id="textuse"> Username</button>

                <ul class="dropdown-menu" id="dropuser">

                    <li><a class="dropdown-item" href="#" id="profiledropM"><img src="/public/img/userdrop.png" alt=""
                                id="img1">Profile</a></li>
                    <li><a class="dropdown-item" href="#" id="passworddropM"><img src="/public/img/key.png" alt=""
                                id="img1">Change
                            Passwaord</a></li>
                    <li><a class="dropdown-item" href="#" id="auctiondropM"><img src="/public/img/auctionuser.png"
                                alt="" id="img1">Auction</a></li>
                    <li><a class="dropdown-item" href="#" id="logouthome"><img src="/public/img/logout.png" alt=""
                                id="img1">Logout</a></li>
                </ul>
            </div>
        </div>

    </nav>






    <div id="democaru" class="carousel slide my-3" data-bs-ride="carousel">

        <div class="carousel-indicators">
            <button type="button" data-bs-target="#demo" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="2"></button>
        </div>

        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="/public/img/banner.png" alt="" class="d-block" style="width:100%">
                <div class="carousel-caption">
                </div>
            </div>

            <div class="carousel-item">
                <img src="/public/img/banner.png" alt="" class="d-block" style="width:100%">
                <div class="carousel-caption"></div>
            </div>

            <div class="carousel-item">
                <img src="/public/img/banner.png" alt="" class="d-block" style="width:100%">
                <div class="carousel-caption">
                </div>
            </div>
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#democaru" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#democaru" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>

    </div>



    <!-- <div class="btn-group" id="groupmenu">
        <button type="button" class="btn" id="btn1" style="background-color: #9F6E3F; color: white;">Home Page</button>
        <button type="button" class="btn" id="btn2">Market Auction</button>
        <button type="button" class="btn" id="btn3">Auction History</button>
        <button type="button" class="btn" id="btn4">Profile</button>
        <button type="button" class="btn" id="btn5">Auction Manual</button>
    </div> -->



    <div class="container-fluid">
        <button type="button" class="btn" id="taladpramul">
            <div class="row">
                <div class="col-2 p-10"><img src="/public/img/Auction.png" alt="" id="imgA"></div>
                <div class="col-sm-5 p-1" id="text5">
                    <h5 id="Ttaladpramul">ตลาดประมูล</h5>
                </div>
            </div>
        </button>

        <button type="button" class="btn" id="taladpramul">
            <div class="row">
                <div class="col-2 p-10"><img src="/public/img/Books.png" alt="" id="imgB"></div>
                <div class="col-sm-7 p-1" id="text5">
                    <h5 id="Ttaladpramul">คู่มือการประมูล</h5>
                </div>
            </div>
        </button>
    </div>



    <div class="container" style="margin-top: 10em;">
        <div class="row mt-5">
            <div class="col-sm-8">
                <div class="table " id="tablenews">
                    <table class="table" style="background-color: white;">
                        <thead>
                            <tr>
                                <th scope="col" style="text-align: left;">
                                    <h4>ข่าวประชาสัมพันธ์</h4>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tabalehomep">




                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-2"></div>

            <div class="container col-sm-2 mt-5">
                <div class="row col-sm-12">
                    <button type="button" id="button-home-news" onclick="toggleButtonStyle('button-home-news')">
                        <img src="/public/img/book-open.png" alt="" style="margin-right: 1em;">ข่าวสารล่าสุด
                    </button>

                    <button type="button" id="button-home-newsauc" onclick="toggleButtonStyle('button-home-newsauc')">
                        <img src="/public/img/dollar-sign.png" alt="" style="margin-right: 1em;">ข่าวการประมูล
                    </button>
                </div>
            </div>

        </div>

    </div>



    <div style="margin-bottom: 10em;"></div>

    <footer style="background-color: #708E60; color: white; text-align: center; padding: 20px;">
        &copy; 2023 ตลาดประมูลการยางภาคเหนือ
    </footer>

    <script src="/public/java/home.js"></script>


    <script>






function toggleButtonStyle(clickedButtonId) {
            const buttonNews = document.getElementById('button-home-news');
            const buttonNewsauc = document.getElementById('button-home-newsauc');
            const tableBody = document.querySelector('#tabalehomep');

            if (clickedButtonId === 'button-home-news') {
                buttonNews.style.borderLeft = '3px solid #00672F';
                buttonNews.style.boxShadow = "0 5px 10px 0 rgba(0, 0, 0, 0.5)";
                buttonNewsauc.style.borderLeft = '1px solid #e0dddd';
                buttonNewsauc.style.boxShadow = "none";

                // เรียกดึงข้อมูลจาก API '/get_news'
                fetch('/HelloNodejs/api/get_news')
                    .then(response => response.json())
                    .then(data => {
                        tableBody.innerHTML = ''; // ล้างเนื้อหาที่มีอยู่เดิม

                        data.forEach(row => {
                            const tr = document.createElement('tr');
                            tr.innerHTML = `
                        <td style="text-align: left;">
                            <div class="row">
                                <h7 class="col-10 textdateNews"></h7>
                                <h5 class="col-9 textdetailNews"></h5>
                            </div>
                        </td>
                    `;

                            const td1 = tr.querySelector('.textdateNews');
                            const isoDate = row.date_news; // วันที่ในรูปแบบ ISO 8601
                            const dateObject = new Date(isoDate);
                            const day = dateObject.getDate();
                            const month = [
                                'ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.',
                                'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.'
                            ][dateObject.getMonth()];
                            const buddhistYear = dateObject.getFullYear() + 543;

                            const formattedDate = `${day} ${month} ${buddhistYear}`;
                            td1.textContent = formattedDate;

                            const td2 = tr.querySelector('.textdetailNews');
                            td2.textContent = row.detail_news;

                            // เพิ่มแถวลงใน tbody
                            tableBody.appendChild(tr);
                        });
                    })
                    .catch(error => {
                        console.error('เกิดข้อผิดพลาดในการดึงข้อมูลผ่าน API: ', error);
                    });
            } else if (clickedButtonId === 'button-home-newsauc') {
                buttonNews.style.borderLeft = '1px solid #e0dddd';
                buttonNews.style.boxShadow = "none";
                buttonNewsauc.style.borderLeft = '3px solid #00672F';
                buttonNewsauc.style.boxShadow = "0 5px 10px 0 rgba(0, 0, 0, 0.5)";

                // เรียกดึงข้อมูลจาก API '/news_auction'
                fetch('/HelloNodejs/api/news_auction')
                    .then(response => response.json())
                    .then(data => {
                        tableBody.innerHTML = ''; // ล้างเนื้อหาที่มีอยู่เดิม

                        data.forEach(row => {
                            const tr = document.createElement('tr');
                            tr.innerHTML = `
                        <td style="text-align: left;">
                            <div class="row">
                                <h7 class="col-10 textdateNews"></h7>
                                <h5 class="col-9 textdetailNews"></h5>
                            </div>
                        </td>
                    `;

                            const td1 = tr.querySelector('.textdateNews');
                            const isoDate = row.date_news; // วันที่ในรูปแบบ ISO 8601
                            const dateObject = new Date(isoDate);
                            const day = dateObject.getDate();
                            const month = [
                                'ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.',
                                'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.'
                            ][dateObject.getMonth()];
                            const buddhistYear = dateObject.getFullYear() + 543;

                            const formattedDate = `${day} ${month} ${buddhistYear}`;
                            td1.textContent = formattedDate;

                            const td2 = tr.querySelector('.textdetailNews');
                            td2.textContent = row.detail_news;

                            // เพิ่มแถวลงใน tbody
                            tableBody.appendChild(tr);
                        });
                    })
                    .catch(error => {
                        console.error('เกิดข้อผิดพลาดในการดึงข้อมูลผ่าน API: ', error);
                    });
            }
        }

        document.addEventListener("DOMContentLoaded", function () {
            const buttonNews = document.getElementById("button-home-news");

            buttonNews.style.borderLeft = '3px solid #00672F';
            buttonNews.style.boxShadow = "0 5px 10px 0 rgba(0, 0, 0, 0.5)";

            // เรียกดึงข้อมูลจาก API '/get_news' เมื่อหน้าเริ่มต้นโหลดเสร็จสมบูรณ์
            fetch('/HelloNodejs/api/get_news')
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.querySelector('#tabalehomep'); // เปลี่ยนเป็น id ของ tbody

                    data.forEach(row => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                    <td style="text-align: left;">
                        <div class="row">
                            <h7 class="col-10 textdateNews"></h7>
                            <h5 class="col-9 textdetailNews"></h5>
                        </div>
                    </td>
                `;

                        const td1 = tr.querySelector('.textdateNews');
                        const isoDate = row.date_news; // วันที่ในรูปแบบ ISO 8601
                        const dateObject = new Date(isoDate);
                        const day = dateObject.getDate();
                        const month = [
                            'ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'ก.พ.', 'มิ.ย.',
                            'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.'
                        ][dateObject.getMonth()];
                        const buddhistYear = dateObject.getFullYear() + 543;
                        const formattedDate = `${day} ${month} ${buddhistYear}`;
                        td1.textContent = formattedDate;

                        const td2 = tr.querySelector('.textdetailNews');
                        td2.textContent = row.detail_news;

                        // เพิ่มแถวลงใน tbody
                        tableBody.appendChild(tr);
                    });
                })
                .catch(error => {
                    console.error('เกิดข้อผิดพลาดในการดึงข้อมูลผ่าน API: ', error);
                });
        });
        




        //============================== root ==================//
        document.querySelector('#profiledropM').onclick = function () {
            location.assign('/HelloNodejs/profile');
        }



        document.querySelector('#taladpramul').onclick = function () {
            location.assign('/HelloNodejs/roombigmarket');
        }



        document.querySelector('#logouthome').onclick = function () {
            fetch("/HelloNodejs/api/logout")  // เปลี่ยนเส้นทาง logout ที่นี่
                .then(function (response) {
                    if (response.ok) {
                        return response.text();
                    }
                    throw Error("Cannot logout");
                })
                .then(function (data) {
                    location.replace(data);
                })
                .catch(function (error) {
                    console.error(error);
                });
        };
    </script>




</body>

</html>