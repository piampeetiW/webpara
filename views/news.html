<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/public/css/log.css">
    <link rel="stylesheet" href="/public/java/home.js">
    <title>News</title>
</head>
<style>
    body,
    html {
        font-family: 'Inter';
        background-size: 100%;
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-position: center;
    }

    #btnA1,
    #btnA2,
    #btnA3,
    #btnA4,
    #btnA5,
    #btnA6,
    #btnA7 {
        border: none;
    }

    #btnA1:hover,
    #btnA2:hover,
    #btnA3:hover,
    #btnA4:hover,
    #btnA6:hover,
    #btnA7:hover {
        background-color: #9F6E3F;
    }

    #btnA7 {
        background-color: #9F6E3F;
    }

    th {
        text-align: center;
    }
</style>

<body id="body">
    <div class="fixed-top">
        <nav class="navbar " id="navhome">
            <div class="container-fluid" id="home">
                <button class="btn" type="button" id="btnhome">
                    <h3 id="taladH">ตลาดประมูลการยางภาคเหนือ</h3>
                </button>
                <div class="dropdown">
                    <button type="button" id="username" class="btn" data-bs-toggle="dropdown"><img
                            src="/public/img/userbutton.png" alt="" id="textuse"> Username</button>

                    <ul class="dropdown-menu" id="dropuser">
                        <li><a class="dropdown-item" href="#"><img src="/public/img/userdrop.png" alt=""
                                    id="img1">Profile</a></li>
                        <li><a class="dropdown-item" href="#"><img src="/public/img/key.png" alt="" id="img1">Change
                                Passwaord</a></li>
                        <li><a class="dropdown-item" href="#"><img src="/public/img/auctionuser.png" alt=""
                                    id="img1">Auction</a></li>
                        <li><a class="dropdown-item" href="#"><img src="/public/img/logout.png" alt="" id="img1">Log
                                out</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="navbar" id="navmenu">
            <div class="btn-group" id="groupmenu">
                <button type="button" class="btn" id="btnA7">Add News</button>
                <button type="button" class="btn" id="btnA2">Market</button>
                <button type="button" class="btn" id="btnA3">Market Sub</button>
                <button type="button" class="btn" id="btnA4">Auction</button>
                <button type="button" class="btn" id="btnA5">User</button>
                <button type="button" class="btn" id="btnA6">Backup-Restore</button>
            </div>
        </div>




    </div>

    <button id="addmarket" style="background-color: #BBD8FA; margin-top: 10em;" data-bs-toggle="modal"
        data-bs-target="#myModal"><img src="/public/img/plus-square.png" alt="" id="imgmark">Add News
    </button>


    <div class="container" id="tableNews" style="margin-right: 20em;">
        <div class="row mt-5">
            <div class="col-2"></div>
            <div class="col-8">
                <div class="table-responsive my-custom-scrollbar">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Details</th>
                            </tr>
                            <tr>
                                <td><input type="text" class="form-control" id="findDateNews" placeholder="Search Date">
                                </td>
                                <td><input type="text" class="form-control" id="findDetailsNews"
                                        placeholder="Search Details"></td>
                            </tr>
                        </thead>
                        <tbody id="NewsDatabody">
                            <!-- ข้อมูลตารางจะถูกเพิ่มที่นี่ -->

                        </tbody>
                    </table>

                </div>
            </div>
            <div class="col-3"></div>
        </div>
    </div>












    <button id="addmarket2" style="background-color: #BBD8FA;" data-bs-toggle="modal" data-bs-target="#myModal2"><img
            src="/public/img/plus-square.png" alt="" id="imgmark">Add News Auction
    </button>

    <div class="container" id="tableNewsAuc" style="margin-right: 20em;">
        <div class="row mt-5">
            <div class="col-2"></div>
            <div class="col-8">
                <div class="table-responsive my-custom-scrollbar">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">Date News Auction</th>
                                <th scope="col">Details News Auction</th>
                            </tr>
                            <tr>
                                <td><input type="text" class="form-control" id="findDateNewsAuc"
                                        placeholder="Search Date News Auction">
                                </td>
                                <td><input type="text" class="form-control" id="findDetailsNewsAuc"
                                        placeholder="Search Details News Auction"></td>
                            </tr>
                        </thead>
                        <tbody id="NewsAucDatabody">
                            <tr>

                            </tr>

                        </tbody>
                    </table>

                </div>
            </div>
            <div class="col-3"></div>
        </div>
    </div>









    <!-- //Modal1 เพิ่มข้อมูล// -->
    <div class="modal fade" id="myModal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" id="windowMtalad">
                <div class="modal-header" style="background-color: #CAD7C2;">
                    <h4 class="modal-title">เพิ่มข่าวสารล่าสุด</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="background-color: #FFF1DB;">
                    <div class="row">
                        <div class="col-2" style="margin-top: 0.5em;">
                            <h6 id="dateNews">วันที่</h6>
                        </div>
                        <div class="col">
                            <input type="date" class="form-control" placeholder="วันที่" name="dateNews"
                                id="adddateNews">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2" style="margin-top: 2em;">
                            <h6 id="detailsNews">รายละเอียด</h6>
                        </div>
                        <div class="col mt-4">
                            <input type="text" class="form-control" autocomplete="off" placeholder="รายละเอียด"
                                name="detailsNews" id="adddetailsNews">
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="background-color: #CAD7C2;">
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal"
                        onclick="addNewsData()">Confirm</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>










    <!-- Modal2 เพิ่มข่าวการประมูล -->
    <div class="modal fade" id="myModal2">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" id="windowMtalad">
                <div class="modal-header" style="background-color: #CAD7C2;">
                    <h4 class="modal-title">เพิ่มข่าวการประมูล</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" style="background-color: #FFF1DB;">
                    <div class="row">
                        <div class="col-2" style="margin-top: 0.5em;">
                            <h6 id="dateNewsauc">วันที่</h6>
                        </div>
                        <div class="col">
                            <input type="date" class="form-control" placeholder="วันที่" name="dateNews"
                                id="add_dateNewsauc">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2" style="margin-top: 2em;">
                            <h6 id="detailsNewsauc">รายละเอียด</h6>
                        </div>
                        <div class="col mt-4">
                            <input type="text" class="form-control" autocomplete="off" placeholder="รายละเอียด"
                                name="detailsNewsauc" id="add_detailsNews">
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="background-color: #CAD7C2;">
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal"
                        onclick="addNewsAucData()">บันทึก</button>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">ยกเลิก</button>
                </div>
            </div>
        </div>
    </div>
















    <script>


        fetch('/HelloNodejs/api/get_news')
            .then(response => response.json())
            .then(data => {
                const tableBody = document.querySelector('#NewsDatabody'); // เปลี่ยนเป็น id ของ tbody

                data.forEach(row => {
                    const tr = document.createElement('tr');

                    const td1 = document.createElement('td');
                    const isoDate = row.date_news; // วันที่ในรูปแบบ ISO 8601
                    const dateObject = new Date(isoDate);
                    const day = dateObject.getDate();
                    const month = [
                        'ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.',
                        'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.'
                    ][dateObject.getMonth()];
                    const buddhistYear = dateObject.getFullYear() + 543;

                    const formattedDate = `${day} ${month} ${buddhistYear}`;
                    td1.textContent = formattedDate;
                    tr.appendChild(td1);

                    const td2 = document.createElement('td');
                    td2.textContent = row.detail_news;
                    tr.appendChild(td2);


                    // เพิ่มแถวลงใน tbody
                    tableBody.appendChild(tr);
                });
            })
            .catch(error => {
                console.error('เกิดข้อผิดพลาดในการดึงข้อมูลผ่าน API: ', error);
            });





        fetch('/HelloNodejs/api/news_auction')
            .then(response => response.json())
            .then(data => {
                const tableBody = document.querySelector('#NewsAucDatabody'); // เปลี่ยนเป็น id ของ tbody

                data.forEach(row => {
                    const tr = document.createElement('tr');

                    const td1 = document.createElement('td');
                    const isoDate = row.date_news_auction; // วันที่ในรูปแบบ ISO 8601
                    const dateObject = new Date(isoDate);
                    const day = dateObject.getDate();
                    const month = [
                        'ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.',
                        'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.'
                    ][dateObject.getMonth()];
                    const buddhistYear = dateObject.getFullYear() + 543;

                    const formattedDate = `${day} ${month} ${buddhistYear}`;
                    td1.textContent = formattedDate;
                    tr.appendChild(td1);

                    const td2 = document.createElement('td');
                    td2.textContent = row.detail_news_auction;
                    tr.appendChild(td2);


                    // เพิ่มแถวลงใน tbody
                    tableBody.appendChild(tr);
                });
            })
            .catch(error => {
                console.error('เกิดข้อผิดพลาดในการดึงข้อมูลผ่าน API: ', error);
            });





        //============== เพิ่มข่าว ===========//
        function addNewsData() {
            const dateNews = document.getElementById('adddateNews').value;
            const detailsNews = document.getElementById('adddetailsNews').value;

            // สร้างออบเจ็กต์เพื่อเก็บข้อมูลข่าวสารที่ต้องการเพิ่ม
            const newsData = {
                date_news: dateNews,
                details_News: detailsNews,
            };

            // ส่งคำขอ HTTP POST ไปยังเซิร์ฟเวอร์พร้อมกับข้อมูลข่าวสาร
            fetch('/HelloNodejs/api/add_news', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(newsData), // ใช้ตัวแปร newsData ที่ประกาศไว้
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Response from server:', data);
                    // อัปเดตหรือแสดงข้อความสำเร็จตามความเหมาะสม
                })
                .catch(error => {
                    console.error('Error adding news data:', error);
                    // แสดงข้อความผิดพลาดหรือจัดการข้อผิดพลาดนี้อย่างเหมาะสม
                });
        }


        //============== เพิ่มข่าวประมูล ===========//
        function addNewsAucData() {
            const add_dateNewsauc = document.getElementById('add_dateNewsauc').value;
            const detailsNewsauc = document.getElementById('add_detailsNews').value;

            // สร้างออบเจ็กต์เพื่อเก็บข้อมูลข่าวสารที่ต้องการเพิ่ม
            const newsDataAuc = {
                date_newsauc: add_dateNewsauc,
                details_Newsauc: detailsNewsauc,
            };

            // ส่งคำขอ HTTP POST ไปยังเซิร์ฟเวอร์พร้อมกับข้อมูลข่าวสาร
            fetch('/HelloNodejs/api/news_auction', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(newsDataAuc), // ใช้ตัวแปร newsData ที่ประกาศไว้
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Response from server:', data);
                    // อัปเดตหรือแสดงข้อความสำเร็จตามความเหมาะสม
                })
                .catch(error => {
                    console.error('Error adding news data:', error);
                    // แสดงข้อความผิดพลาดหรือจัดการข้อผิดพลาดนี้อย่างเหมาะสม
                });
        }
























        //========================== root ========================//
        document.querySelector('#btnhome').onclick = function () {
            location.assign('/HelloNodejs/homepage');
        }

        document.querySelector('#btnA2').onclick = function () {
            location.assign('/HelloNodejs/marketad');
        }

        document.querySelector('#btnA4').onclick = function () {
            location.assign('/HelloNodejs/auctionAd');
        }

        document.querySelector('#btnA5').onclick = function () {
            location.assign('/HelloNodejs/useradmin');

        }
    </script>
</body>


</html>